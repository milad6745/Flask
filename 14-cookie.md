
# Cookie
کوکی‌ها (Cookies) یکی از روش‌های ذخیره سازی اطلاعات در مرورگر کاربر هستند. این اطلاعات به صورت کوجک‌های متنی در مرورگر ذخیره می‌شوند و می‌توانند اطلاعاتی همچون نام کاربری، تنظیمات وضعیت و وضعیت ورود به حساب کاربری را در خود نگه دارند.

در محیط وب، کوکی‌ها برای اجازه دادن به وب‌سایت‌ها برای ذخیره اطلاعات در مرورگر کاربر استفاده می‌شوند تا بتوانند کاربران را شناسایی کرده و اطلاعات مختلفی را در هنگام استفاده از وب‌سایت ذخیره کنند.

در Flask، می‌توان از ماژول `make_response` برای ساخت و تنظیم کوکی‌ها استفاده کرد. 

### مراحل استفاده از کوکی در Flask:

1. **وارد کردن ماژول‌ها**:
   در ابتدا، ماژول‌های مربوط به کوکی‌ها باید وارد شوند. در Flask معمولاً از `make_response` استفاده می‌شود.

   ```python
   from flask import make_response
   ```

2. **ساخت یک پاسخ**:
   برای ساخت یک پاسخ، از تابع `make_response` استفاده می‌شود:

   ```python
   resp = make_response()
   ```

3. **تنظیم کوکی**:
   سپس می‌توان کوکی‌ها را با استفاده از تابع `resp.set_cookie()` تنظیم کرد. این تابع نیاز به نام کوکی و مقدار آن دارد:

   ```python
   resp.set_cookie('نام_کوکی', 'مقدار_کوکی')
   ```

4. **ارسال پاسخ**:
   حتما باید پاسخ به کاربر ارسال شود. این کار با استفاده از دستور `return` انجام می‌شود:

   ```python
   return resp
   ```

نکته: این کد باید در تابع مربوط به یک مسیر در برنامه Flask شما قرار گیرد تا کوکی در زمانی که کاربر به آن مسیر دسترسی پیدا می‌کند، تنظیم شود.

به عنوان مثال:

```python
from flask import Flask, make_response

app = Flask(__name__)

@app.route('/')
def set_cookie():
    resp = make_response("کوکی تنظیم شد!")
    resp.set_cookie('username', 'john_doe')
    return resp

if __name__ == '__main__':
    app.run(debug=True)
```

در این مثال، وقتی کاربر به مسیر `/` دسترسی پیدا می‌کند، یک پاسخ ایجاد می‌شود و کوکی با نام "username" و مقدار "john_doe" تنظیم می‌شود و سپس به کاربر ارسال می‌شود.





 در Flask، می‌توانید از ماژول `Flask` و `make_response` برای کار با کوکی‌ها استفاده کنید. در زیر یک مثال ساده از چگونگی استفاده از کوکی در Flask آمده است:



# Example
```python
from flask import Flask, render_template, request, make_response

app = Flask(__name__)

@app.route('/')
def index():
    username = request.cookies.get('username')
    if username:
        return f"سلام {username}! شما وارد شده‌اید."
    else:
        return render_template('login.html')

@app.route('/login', methods=['POST'])
def login():
    username = request.form.get('username')
    
    if username:
        resp = make_response(f"ورود شما با موفقیت ثبت شد. سلام {username}!")
        resp.set_cookie('username', username)
        return resp
    else:
        return "لطفا نام کاربری خود را وارد کنید."

if __name__ == '__main__':
    app.run(debug=True)
```

```html
<!doctype html>
<html>
    <head>
        <title>ورود</title>
    </head>
    <body>
        <h2>لطفا وارد شوید</h2>
        <form action="/login" method="post">
            <input type="text" name="username" placeholder="نام کاربری">
            <input type="submit" value="ورود">
        </form>
    </body>
</html>
```
بطور کلی، این کد یک برنامه Flask ایجاد می‌کند که از کاربر نام کاربری دریافت می‌کند، آن را در یک کوکی ذخیره می‌کند و اگر کاربر قبلاً وارد شده باشد، نام کاربری را از کوکی بازیابی می‌کند. حالا دستورات خط به خط را توضیح می‌دهم:

`from flask import Flask, render_template, request, make_response`:

در اینجا ما ماژول‌هایی که برای اجرای این برنامه Flask لازم هستند را وارد می‌کنیم. این ماژول‌ها شامل `Flask` برای ایجاد برنامه Flask، `render_template` برای نمایش قالب‌های HTML، `request` برای دسترسی به اطلاعات درخواست HTTP و `make_response` برای ایجاد یک پاسخ سفارشی هستند.

`app = Flask(__name__)`:

در اینجا یک نمونه از کلاس `Flask` ایجاد می‌شود و به متغیر `app` اختصاص داده می‌شود. این نمونه به عنوان اصلی‌ترین قسمت برنامه Flask عمل می‌کند.

`@app.route('/')`: 

این دکوراتور مسیر اصلی وب‌سایت را تعریف می‌کند که از آدرس `/` شروع می‌شود. هنگامی که کاربر به این مسیر دسترسی پیدا می‌کند، تابع `index()` اجرا می‌شود.

`def index():`: 

این تابع به عنوان مدیریت کننده مسیر اصلی عمل می‌کند. ابتدا چک می‌شود که آیا کوکی با نام "username" وجود دارد یا نه. اگر وجود داشته باشد، نام کاربری از کوکی می‌خواند و نمایش می‌دهد وگرنه از کاربر درخواست می‌کند که نام کاربری خود را وارد کند.

`@app.route('/login', methods=['POST'])`: 

این دکوراتور مسیر "/login" را تعریف می‌کند و تنها از متد POST پشتیبانی می‌کند. این مسیر برای دریافت نام کاربری از فرم استفاده می‌شود.

`def login():`: 

این تابع به عنوان مدیریت کننده مسیر "/login" عمل می‌کند. نام کاربری از فرم POST دریافت می‌شود. اگر کاربر نام کاربری وارد کند، یک پاسخ ساخته شده و با پیام خوش آمدگویی و نام کاربری تنظیم می‌شود و به عنوان کوکی به کاربر داده می‌شود.

`if __name__ == '__main__':`: 

این شرط بررسی می‌کند که برنامه به عنوان اصلی اجرا شده باشد و نه به عنوان یک ماژول در داخل یک برنامه دیگر. اگر برنامه به عنوان اصلی اجرا شود، دستور `app.run(debug=True)` فراخوانی می‌شود تا وب‌سرور Flask روشن شود.

با این کد، شما می‌توانید یک برنامه Flask ایجاد کنید که نام کاربری را از کاربر دریافت کرده و در کوکی ذخیره کند، و در صورت ورود مجدد کاربر، نام کاربری را از کوکی بازیابی کند.
